# Product Requirements Document (PRD): JejakBelajar

**Version**: 9.0 (Definitive)
**Date**: October 4, 2025

## 1. Introduction & Core Concepts

### 1.1. Vision
[cite_start]**JejakBelajar** is a digital platform designed to facilitate the standardized implementation and documentation of **Assessment as Learning (AaL)** within the *Projek Penguatan Profil Pelajar Pancasila* (P5) co-curricular framework[cite: 1]. The platform aims to create a consistent, structured, and digitally native assessment experience for high school projects.

### 1.2. Guiding Principles & Conceptual Framework
[cite_start]The application is architected around the **Assessment as Learning (AaL) Model**, which is built on core theoretical foundations including Progressivism, Social Constructivism, Metacognition, and Self-Regulated Learning[cite: 2, 4, 5, 6, 7]. [cite_start]This model is expressed through five key components that guide the platform's design[cite: 21, 22]:
1.  [cite_start]**Goal**: Defining learning objectives at the project's outset[cite: 23, 28].
2.  [cite_start]**Success Criteria**: Establishing transparent assessment criteria for the entire project[cite: 24, 28].
3.  [cite_start]**Task**: Providing structured, sequential assignments through a Project-Based Learning workflow[cite: 25, 28].
4.  [cite_start]**Feedback**: Integrating multi-source feedback from peers (`Peer-assessment`), teachers (`Teacher-assessment`), and self-reflection (`Self-assessment`)[cite: 26, 28].
5.  [cite_start]**Reporting**: Empowering students to report on their own learning, culminating in a **Student-Led Conference**[cite: 27, 28].

[cite_start]The practical implementation of this model is achieved through a standardized **Project-Based Learning (PjBL)** syntax[cite: 20].

---

## 2. User Roles and Permissions

The platform features three distinct user roles with specific, segregated access rights.

### 2.1. School Admin
Acts as the central **Curriculum and Assessment Manager**.
* **Academic Structure Management**: Performs full CRUD operations on Academic Terms (Year & Semester) and Classes.
* **Account Management**: Performs full CRUD operations on Teacher and Student accounts.
* **User Assignment**: Assigns teachers and students to their respective classes.
* **Project Template Management**: Has exclusive rights to create and manage **Project Templates**. This critical function includes:
    * Defining the overall **Success Criteria** for a project template.
    * Configuring the 6 PjBL stages and defining **one or more required output instruments** for each stage.
    * Writing the official, unchangeable **questions/statements** for all questionnaire-based instruments (`Self-Assessment`, `Peer-Assessment`, `Observation Sheet`).
    * Writing the official, unchangeable **guiding prompt(s)** for all `Reflection Journal` instruments.
    * [cite_start]Creating and managing a library of detailed **scoring rubrics specifically for the Reflection Journal**, defining the indicators and descriptive criteria for each score level[cite: 45, 46].
* **Monitoring**: Views aggregate, school-level reports.

### 2.2. Teacher
Acts as a **Project Facilitator**.
* **Project Instantiation**: Initiates a new project by **selecting from a list of predefined Project Templates**.
* **Project Contextualization**: Fills in project-specific details such as the official Title and Theme.
* **Group Management**: Forms and manages student groups.
* **Facilitation & Assessment**: Monitors student progress, provides written feedback, and assesses student work. This includes:
    * Grading `Reflection Journals` against multiple indicators. [cite_start]The User Interface **must display the relevant, Admin-defined rubric criteria** to the teacher to ensure objective grading[cite: 45, 46].
    * [cite_start]Filling out `Observation Sheets` for every student in the class based on the predefined statements and scoring scale[cite: 29].
* [cite_start]**Reporting**: Is responsible for compiling the co-curricular report (`Rapor Kokurikuler`) generated by the system[cite: 29].
* **Limitations**: The Teacher **cannot** alter the stages, outputs, assessment questions, or scoring rubrics defined in the Admin's template.

### 2.3. Student
The learner who actively participates in the project.
* **Task Completion**: Completes **all required outputs** for a given stage in sequence before the next stage is unlocked. This includes:
    * Writing in a **Reflection Journal** using a **Rich Text Editor**.
    * Completing **Self-Assessment Questionnaires**.
    * Completing **Peer-Assessment Questionnaires** for all other **N-1** members of their group.
* **Feedback Loop**: Receives and views feedback from their teacher and anonymized summary scores from their peers.
* [cite_start]**Reporting**: Prepares a portfolio and leads the **Student-Led Conference** to explain their learning journey and achievements across the different dimensions[cite: 29].

---

## 3. Detailed Workflows and Features

### 3.1. Admin Workflow: Project Template Management
1.  **Initiate Template Creation**: Admin navigates to the "Project Templates" section.
2.  **Define Template Metadata**: Admin enters a **Template Name**, a **Description**, and defines the overall **Success Criteria** for the template.
3.  **Configure Stages**: The Admin configures each of the 6 PjBL stages by adding one or more output instruments.
4.  **Define Instrument Content & Rubrics**:
    * If the output is a **Questionnaire** (`SELF_ASSESSMENT`, `PEER_ASSESSMENT`, `OBSERVATION`), the Admin adds questions/statements to the `template_questions` table.
    * If the output is a **Journal**, the Admin first adds one or more **prompts** via the `prompt_text` field. Then, the Admin defines the detailed, multi-indicator rubric for this journal by adding entries to the `template_journal_rubrics` table.
5.  **Save Template**: The Admin saves the completed template, making it available to teachers.

### 3.2. Teacher Workflow: Project Facilitation & Assessment
1.  **Select Project Template**: Teacher selects an active template from a list.
2.  **Fill Project Details**: Teacher enters a unique **Title** and **Theme**.
3.  **Manage Groups**: Teacher creates groups and assigns students.
4.  **Publish Project**.
5.  **Assess Student Work**: For a submitted `Reflection Journal`, the teacher views the student's text alongside the full, multi-indicator scoring rubric (fetched from `template_journal_rubrics`) and assigns a score for each indicator.

### 3.3. Student Workflow: Project Execution
1.  **Access Project**: Student selects the active project and reviews the overall **Success Criteria**.
2.  **Enter Stage**: Student enters the current active stage. Subsequent stages are locked.
3.  **Complete Outputs**: The student sees a checklist of required outputs for the stage and completes them.
4.  **Proceed**: Once all outputs for a stage are submitted, the next stage is unlocked.

### 3.4. Module: Assessment & Reporting Engine
* [cite_start]**Instrument Types**: The platform supports `Reflection Journal` and questionnaire-based instruments (`Self-Assessment`, `Peer-Assessment`, `Observation Sheet`)[cite: 36].
* [cite_start]**Questionnaire Scoring Scale**: All questionnaire items use a 4-point Likert scale with fixed scoring[cite: 47, 48]:
    * **Always**: 4 points
    * **Often**: 3 points
    * **Sometimes**: 2 points
    * **Never**: 1 point
* [cite_start]**Journal Scoring**: Journals are assessed against a detailed, multi-indicator rubric with descriptive criteria for each score level (1-4)[cite: 45, 46].
* **Data Storage Model for Grades**:
    * For **Questionnaires**, answers are stored in `submissions.content` as a JSON object mapping question IDs to scores.
    * For **Journals**, the `submissions.content` column stores a composite JSON object containing both the student's submission and the teacher's detailed grades (e.g., `{"student_answers": [...], "grades": [{"rubric_id": ..., "score": 4}, ...]}`).
* **Reporting Flow**:
    1.  [cite_start]**Score Aggregation**: The system collects all scores for a student and groups them by dimension according to the "Rekapitulasi Penskoran" table[cite: 51, 52].
    2.  [cite_start]**Quantitative Score Calculation**: The achievement score (X) for each dimension is calculated using the formula[cite: 54, 55]: $$X = \frac{\text{sum of all item scores}}{\text{total items} \times 4} \times 100$$
    3.  [cite_start]**Qualitative Score Conversion**: The score (X) is converted into a qualitative category by calculating the Ideal Mean (¬µ) and Ideal Standard Deviation (ùùà) and comparing against the predefined intervals[cite: 61, 62]. [cite_start]The formulas are[cite: 64, 65]: $$¬µ = \frac{1}{2}(\text{ideal minimum score} + \text{ideal maximum score})$$ $$ùùà = \frac{1}{2}(\text{ideal maximum score} - \text{ideal minimum score})$$

---

## 4. Non-Functional Requirements
* **User Experience**: Intuitive, responsive, and accessible.
* **Code Quality**: Modular, reusable components, clean, and maintainable.
* **Security & Reliability**: Role-based access control and automated backups.
* **Scalability & Performance**:
    * The application architecture must be scalable to handle peak loads, such as many students submitting assignments simultaneously.
    * For production deployment with a significant number of users (e.g., 300 concurrent users), the free tiers of Vercel and Neon are insufficient and **must be upgraded** to paid plans.
    * **Load testing** should be performed before full deployment to identify bottlenecks and confirm capacity.

---

## 5. Technical Specifications
* **Frontend Framework**: Next.js
* **Styling**: Tailwind CSS
* **UI Component Library**: shadcn/ui (using the **shadcn-blocks** dashboard template).
* **Database**: Neon (Serverless PostgreSQL)
* **Authentication**: NextAuth.js (Auth.js).

---

## 6. Appendix A: Application Flow Diagram

```mermaid
graph TD
    subgraph School Admin
        A1[Login] --> A2{Manage System};
        A2 --> A3[1. CRUD Academic Terms, Users, Classes];
        A2 --> A4[2. <b>Create/Edit Project Templates</b>];
        A4 --> A5[Define Stages, Outputs, Questions & <b>Journal Rubrics</b>];
    end

    subgraph Teacher
        B1[Login] --> B2[Create New Project];
        B2 --> B3[<b>Select a Project Template</b>];
        B3 --> B4[Fill Project Details (Title, Theme)];
        B4 --> B5[Form Student Groups];
        B5 --> B6[Publish Project];
        B6 --> B7{Monitor & Grade <b>with System-Provided Rubrics</b>};
    end

    subgraph Student
        C1[Login] --> C2[View Active Project & Success Criteria];
        C2 --> C3{Work Through Standardized Stages};
        C3 --> C4[<b>Stage 1:</b> Complete <b>All</b> Predefined Outputs];
        C4 --> C5[<b>Stage 2:</b> Complete <b>All</b> Predefined Outputs];
        C5 --> C6[...]
        C6 --> C7[Project Complete & View Report];
    end

    %% Flow of Interaction
    A3 -- Master data is ready --> B1;
    A5 -- Templates are ready --> B2;
    B6 -- Project instance is active --> C2;
    C4 -- Submissions --> B7;
    C5 -- Submissions --> B7;



-- Table to manage academic terms
CREATE TABLE academic_terms (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    academic_year VARCHAR(10) NOT NULL, -- e.g., '2025/2026'
    semester ENUM('ODD', 'EVEN') NOT NULL,
    status ENUM('ACTIVE', 'INACTIVE') NOT NULL DEFAULT 'INACTIVE',
    UNIQUE(academic_year, semester)
);

-- Table for all system users
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    role ENUM('ADMIN', 'TEACHER', 'STUDENT') NOT NULL,
    created_at TIMESTAMPTZ DEFAULT now()
);

-- A table to store the master list of assessment dimensions.
CREATE TABLE dimensions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) UNIQUE NOT NULL, -- e.g., "Kreativitas", "Kolaborasi"
    created_by_admin_id UUID REFERENCES users(id) ON DELETE SET NULL
);

-- Central table for defining project templates, managed by Admin
CREATE TABLE project_templates (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    template_name VARCHAR(255) UNIQUE NOT NULL,
    description TEXT,
    success_criteria JSONB, -- Stores the overall project success criteria
    created_by_admin_id UUID REFERENCES users(id) ON DELETE SET NULL,
    is_active BOOLEAN DEFAULT TRUE
);

-- Defines the stages and required instruments for each template.
CREATE TABLE template_stage_configs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    template_id UUID REFERENCES project_templates(id) ON DELETE CASCADE,
    stage_name VARCHAR(255) NOT NULL,
    instrument_type ENUM('JOURNAL', 'SELF_ASSESSMENT', 'PEER_ASSESSMENT', 'OBSERVATION') NOT NULL,
    prompt_text TEXT, -- For student-facing prompts (primarily for Journals)
    display_order INT NOT NULL
);

-- This table is now ONLY for questionnaire items (Self, Peer, Observation).
CREATE TABLE template_questions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    config_id UUID REFERENCES template_stage_configs(id) ON DELETE CASCADE,
    question_text TEXT NOT NULL,
    dimension_id UUID REFERENCES dimensions(id) ON DELETE SET NULL -- Links question to a dimension
);

-- A dedicated table ONLY for the complex rubric of the Reflective Journal.
CREATE TABLE template_journal_rubrics (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    config_id UUID REFERENCES template_stage_configs(id) ON DELETE CASCADE, -- Links to the Journal instrument
    indicator_text TEXT NOT NULL, -- e.g., "Mengajukan pertanyaan terbuka..."
    criteria JSONB, -- e.g., {"4": "Description for score 4", "3": "..."}
    dimension_id UUID REFERENCES dimensions(id) ON DELETE SET NULL -- Links indicator to a dimension
);

-- Project instances created by Teachers, linked to a template
CREATE TABLE projects (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    title VARCHAR(255) NOT NULL,
    theme VARCHAR(255),
    class_id UUID REFERENCES classes(id) ON DELETE CASCADE,
    teacher_id UUID REFERENCES users(id) ON DELETE SET NULL,
    template_id UUID REFERENCES project_templates(id) ON DELETE RESTRICT,
    status ENUM('DRAFT', 'PUBLISHED', 'ARCHIVED') DEFAULT 'DRAFT',
    created_at TIMESTAMPTZ DEFAULT now()
);

-- Table for student groups
CREATE TABLE groups (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE
);

-- Pivot table for group members
CREATE TABLE group_members (
    group_id UUID REFERENCES groups(id) ON DELETE CASCADE,
    student_id UUID REFERENCES users(id) ON DELETE CASCADE,
    PRIMARY KEY (group_id, student_id)
);

-- Table to store all student submissions and teacher assessments
CREATE TABLE submissions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    student_id UUID REFERENCES users(id) ON DELETE CASCADE,
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    template_stage_config_id UUID REFERENCES template_stage_configs(id),
    
    -- Content of the submission.
    -- For questionnaires: {"template_question_id": score, ...}
    -- For journals: {"student_answers": [{"prompt_id": ..., "answer_html": ...}], "grades": [{"rubric_id": ..., "score": 4}, ...]}
    content JSONB,
    
    target_student_id UUID REFERENCES users(id) ON DELETE CASCADE NULL, -- For Peer-Assessment
    
    -- The final/average score for quick access.
    score FLOAT, 
    feedback TEXT, -- Overall feedback from the teacher
    
    submitted_at TIMESTAMPTZ DEFAULT now()
);